
\documentclass[border=8pt, multi, tikz]{standalone}
\usepackage{import}
\subimport{../Layers/}{init}
\usetikzlibrary{positioning}
\usetikzlibrary{3d} %for including external image

\newcommand{\copymidarrow}{\tikz \draw[-Stealth,line width=0.8mm,draw={rgb:blue,4;red,1;green,1;black,3}] (-0.3,0) -- ++(0.3,0);}

\begin{document}
\begin{tikzpicture}
\tikzstyle{connection}=[ultra thick,every node/.style={sloped,allow upside down},draw=\edgecolor,opacity=0.7]
\tikzstyle{copyconnection}=[ultra thick,every node/.style={sloped,allow upside down},draw={rgb:blue,4;red,1;green,1;black,3},opacity=0.7]

\pic[shift={(0,0,0)}] at (0,0,0) {
    Box={
        name=conv1,
        caption=7x7 Conv,
        xlabel={64},
        zlabel=64,
        fill=\ConvColor,
        height=80,
        width=2,
        depth=80
    }
};


\pic[shift=(1,0,0)] at (conv1-east) {
    Box={
        name=pool1,
        caption=3x3 MaxPool,
        fill=\PoolColor,
        opacity=0.5,
        height=40,
        width=1,
        depth=40
    }
};

\pic[shift=(1,0,0)] at (pool1-east) {
    Box={
        name=conv2_1_conv1,
        caption=1x1,
        xlabel={ 64, },
        zlabel=64,
        fill=\ConvColor,
        height=40,
        width=1,
        depth=40
    }
};

\pic[shift=(1,0,0)] at (conv2_1_conv1-east) {
    Box={
        name=conv2_1_conv2,
        caption=3x3,
        xlabel={ 64, },
        zlabel=64,
        fill=\ConvColor,
        height=40,
        width=2,
        depth=40
    }
};

\pic[shift=(1,0,0)] at (conv2_1_conv2-east) {
    Box={
        name=conv2_1_conv3,
        caption=1x1,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=40,
        width=1,
        depth=40
    }
};

\draw [connection]  (conv2_1_conv1-east) -- node {\midarrow} (conv2_1_conv2-west);

\draw [connection]  (conv2_1_conv2-east) -- node {\midarrow} (conv2_1_conv3-west);

\pic[shift=(1,0,0)] at (conv2_1_conv3-east) {
    Box={
        name=conv2_2_conv1,
        caption=1x1,
        xlabel={ 64, },
        zlabel=64,
        fill=\ConvColor,
        height=40,
        width=1,
        depth=40
    }
};

\pic[shift=(1,0,0)] at (conv2_2_conv1-east) {
    Box={
        name=conv2_2_conv2,
        caption=3x3,
        xlabel={ 64, },
        zlabel=64,
        fill=\ConvColor,
        height=40,
        width=2,
        depth=40
    }
};

\pic[shift=(1,0,0)] at (conv2_2_conv2-east) {
    Box={
        name=conv2_2_conv3,
        caption=1x1,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=40,
        width=1,
        depth=40
    }
};

\draw [connection]  (conv2_2_conv1-east) -- node {\midarrow} (conv2_2_conv2-west);

\draw [connection]  (conv2_2_conv2-east) -- node {\midarrow} (conv2_2_conv3-west);

\pic[shift=(1,0,0)] at (conv2_2_conv3-east) {
    Box={
        name=conv2_3_conv1,
        caption=1x1,
        xlabel={ 64, },
        zlabel=64,
        fill=\ConvColor,
        height=40,
        width=1,
        depth=40
    }
};

\pic[shift=(1,0,0)] at (conv2_3_conv1-east) {
    Box={
        name=conv2_3_conv2,
        caption=3x3,
        xlabel={ 64, },
        zlabel=64,
        fill=\ConvColor,
        height=40,
        width=2,
        depth=40
    }
};

\pic[shift=(1,0,0)] at (conv2_3_conv2-east) {
    Box={
        name=conv2_3_conv3,
        caption=1x1,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=40,
        width=1,
        depth=40
    }
};

\draw [connection]  (conv2_3_conv1-east) -- node {\midarrow} (conv2_3_conv2-west);

\draw [connection]  (conv2_3_conv2-east) -- node {\midarrow} (conv2_3_conv3-west);

\pic[shift=(1,0,0)] at (conv2_3_conv3-east) {
    Box={
        name=conv3_1_conv1,
        caption=1x1,
        xlabel={ 128, },
        zlabel=128,
        fill=\ConvColor,
        height=32,
        width=1,
        depth=32
    }
};

\pic[shift=(1,0,0)] at (conv3_1_conv1-east) {
    Box={
        name=conv3_1_conv2,
        caption=3x3,
        xlabel={ 128, },
        zlabel=128,
        fill=\ConvColor,
        height=32,
        width=2,
        depth=32
    }
};

\pic[shift=(1,0,0)] at (conv3_1_conv2-east) {
    Box={
        name=conv3_1_conv3,
        caption=1x1,
        xlabel={ 512, },
        zlabel=512,
        fill=\ConvColor,
        height=32,
        width=1,
        depth=32
    }
};

\draw [connection]  (conv3_1_conv1-east) -- node {\midarrow} (conv3_1_conv2-west);

\draw [connection]  (conv3_1_conv2-east) -- node {\midarrow} (conv3_1_conv3-west);

\pic[shift=(1,0,0)] at (conv3_1_conv3-east) {
    Box={
        name=conv3_2_conv1,
        caption=1x1,
        xlabel={ 128, },
        zlabel=128,
        fill=\ConvColor,
        height=32,
        width=1,
        depth=32
    }
};

\pic[shift=(1,0,0)] at (conv3_2_conv1-east) {
    Box={
        name=conv3_2_conv2,
        caption=3x3,
        xlabel={ 128, },
        zlabel=128,
        fill=\ConvColor,
        height=32,
        width=2,
        depth=32
    }
};

\pic[shift=(1,0,0)] at (conv3_2_conv2-east) {
    Box={
        name=conv3_2_conv3,
        caption=1x1,
        xlabel={ 512, },
        zlabel=512,
        fill=\ConvColor,
        height=32,
        width=1,
        depth=32
    }
};

\draw [connection]  (conv3_2_conv1-east) -- node {\midarrow} (conv3_2_conv2-west);

\draw [connection]  (conv3_2_conv2-east) -- node {\midarrow} (conv3_2_conv3-west);

\pic[shift=(1,0,0)] at (conv3_2_conv3-east) {
    Box={
        name=conv3_3_conv1,
        caption=1x1,
        xlabel={ 128, },
        zlabel=128,
        fill=\ConvColor,
        height=32,
        width=1,
        depth=32
    }
};

\pic[shift=(1,0,0)] at (conv3_3_conv1-east) {
    Box={
        name=conv3_3_conv2,
        caption=3x3,
        xlabel={ 128, },
        zlabel=128,
        fill=\ConvColor,
        height=32,
        width=2,
        depth=32
    }
};

\pic[shift=(1,0,0)] at (conv3_3_conv2-east) {
    Box={
        name=conv3_3_conv3,
        caption=1x1,
        xlabel={ 512, },
        zlabel=512,
        fill=\ConvColor,
        height=32,
        width=1,
        depth=32
    }
};

\draw [connection]  (conv3_3_conv1-east) -- node {\midarrow} (conv3_3_conv2-west);

\draw [connection]  (conv3_3_conv2-east) -- node {\midarrow} (conv3_3_conv3-west);

\pic[shift=(1,0,0)] at (conv3_3_conv3-east) {
    Box={
        name=conv3_4_conv1,
        caption=1x1,
        xlabel={ 128, },
        zlabel=128,
        fill=\ConvColor,
        height=32,
        width=1,
        depth=32
    }
};

\pic[shift=(1,0,0)] at (conv3_4_conv1-east) {
    Box={
        name=conv3_4_conv2,
        caption=3x3,
        xlabel={ 128, },
        zlabel=128,
        fill=\ConvColor,
        height=32,
        width=2,
        depth=32
    }
};

\pic[shift=(1,0,0)] at (conv3_4_conv2-east) {
    Box={
        name=conv3_4_conv3,
        caption=1x1,
        xlabel={ 512, },
        zlabel=512,
        fill=\ConvColor,
        height=32,
        width=1,
        depth=32
    }
};

\draw [connection]  (conv3_4_conv1-east) -- node {\midarrow} (conv3_4_conv2-west);

\draw [connection]  (conv3_4_conv2-east) -- node {\midarrow} (conv3_4_conv3-west);

\pic[shift=(1,0,0)] at (conv3_4_conv3-east) {
    Box={
        name=conv4_1_conv1,
        caption=1x1,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_1_conv1-east) {
    Box={
        name=conv4_1_conv2,
        caption=3x3,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=2,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_1_conv2-east) {
    Box={
        name=conv4_1_conv3,
        caption=1x1,
        xlabel={ 1024, },
        zlabel=1024,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\draw [connection]  (conv4_1_conv1-east) -- node {\midarrow} (conv4_1_conv2-west);

\draw [connection]  (conv4_1_conv2-east) -- node {\midarrow} (conv4_1_conv3-west);

\pic[shift=(1,0,0)] at (conv4_1_conv3-east) {
    Box={
        name=conv4_2_conv1,
        caption=1x1,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_2_conv1-east) {
    Box={
        name=conv4_2_conv2,
        caption=3x3,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=2,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_2_conv2-east) {
    Box={
        name=conv4_2_conv3,
        caption=1x1,
        xlabel={ 1024, },
        zlabel=1024,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\draw [connection]  (conv4_2_conv1-east) -- node {\midarrow} (conv4_2_conv2-west);

\draw [connection]  (conv4_2_conv2-east) -- node {\midarrow} (conv4_2_conv3-west);

\pic[shift=(1,0,0)] at (conv4_2_conv3-east) {
    Box={
        name=conv4_3_conv1,
        caption=1x1,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_3_conv1-east) {
    Box={
        name=conv4_3_conv2,
        caption=3x3,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=2,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_3_conv2-east) {
    Box={
        name=conv4_3_conv3,
        caption=1x1,
        xlabel={ 1024, },
        zlabel=1024,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\draw [connection]  (conv4_3_conv1-east) -- node {\midarrow} (conv4_3_conv2-west);

\draw [connection]  (conv4_3_conv2-east) -- node {\midarrow} (conv4_3_conv3-west);

\pic[shift=(1,0,0)] at (conv4_3_conv3-east) {
    Box={
        name=conv4_4_conv1,
        caption=1x1,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_4_conv1-east) {
    Box={
        name=conv4_4_conv2,
        caption=3x3,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=2,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_4_conv2-east) {
    Box={
        name=conv4_4_conv3,
        caption=1x1,
        xlabel={ 1024, },
        zlabel=1024,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\draw [connection]  (conv4_4_conv1-east) -- node {\midarrow} (conv4_4_conv2-west);

\draw [connection]  (conv4_4_conv2-east) -- node {\midarrow} (conv4_4_conv3-west);

\pic[shift=(1,0,0)] at (conv4_4_conv3-east) {
    Box={
        name=conv4_5_conv1,
        caption=1x1,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_5_conv1-east) {
    Box={
        name=conv4_5_conv2,
        caption=3x3,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=2,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_5_conv2-east) {
    Box={
        name=conv4_5_conv3,
        caption=1x1,
        xlabel={ 1024, },
        zlabel=1024,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\draw [connection]  (conv4_5_conv1-east) -- node {\midarrow} (conv4_5_conv2-west);

\draw [connection]  (conv4_5_conv2-east) -- node {\midarrow} (conv4_5_conv3-west);

\pic[shift=(1,0,0)] at (conv4_5_conv3-east) {
    Box={
        name=conv4_6_conv1,
        caption=1x1,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_6_conv1-east) {
    Box={
        name=conv4_6_conv2,
        caption=3x3,
        xlabel={ 256, },
        zlabel=256,
        fill=\ConvColor,
        height=24,
        width=2,
        depth=24
    }
};

\pic[shift=(1,0,0)] at (conv4_6_conv2-east) {
    Box={
        name=conv4_6_conv3,
        caption=1x1,
        xlabel={ 1024, },
        zlabel=1024,
        fill=\ConvColor,
        height=24,
        width=1,
        depth=24
    }
};

\draw [connection]  (conv4_6_conv1-east) -- node {\midarrow} (conv4_6_conv2-west);

\draw [connection]  (conv4_6_conv2-east) -- node {\midarrow} (conv4_6_conv3-west);

\pic[shift=(1,0,0)] at (conv4_6_conv3-east) {
    Box={
        name=conv5_1_conv1,
        caption=1x1,
        xlabel={ 512, },
        zlabel=512,
        fill=\ConvColor,
        height=16,
        width=1,
        depth=16
    }
};

\pic[shift=(1,0,0)] at (conv5_1_conv1-east) {
    Box={
        name=conv5_1_conv2,
        caption=3x3,
        xlabel={ 512, },
        zlabel=512,
        fill=\ConvColor,
        height=16,
        width=2,
        depth=16
    }
};

\pic[shift=(1,0,0)] at (conv5_1_conv2-east) {
    Box={
        name=conv5_1_conv3,
        caption=1x1,
        xlabel={ 2048, },
        zlabel=2048,
        fill=\ConvColor,
        height=16,
        width=1,
        depth=16
    }
};

\draw [connection]  (conv5_1_conv1-east) -- node {\midarrow} (conv5_1_conv2-west);

\draw [connection]  (conv5_1_conv2-east) -- node {\midarrow} (conv5_1_conv3-west);

\pic[shift=(1,0,0)] at (conv5_1_conv3-east) {
    Box={
        name=conv5_2_conv1,
        caption=1x1,
        xlabel={ 512, },
        zlabel=512,
        fill=\ConvColor,
        height=16,
        width=1,
        depth=16
    }
};

\pic[shift=(1,0,0)] at (conv5_2_conv1-east) {
    Box={
        name=conv5_2_conv2,
        caption=3x3,
        xlabel={ 512, },
        zlabel=512,
        fill=\ConvColor,
        height=16,
        width=2,
        depth=16
    }
};

\pic[shift=(1,0,0)] at (conv5_2_conv2-east) {
    Box={
        name=conv5_2_conv3,
        caption=1x1,
        xlabel={ 2048, },
        zlabel=2048,
        fill=\ConvColor,
        height=16,
        width=1,
        depth=16
    }
};

\draw [connection]  (conv5_2_conv1-east) -- node {\midarrow} (conv5_2_conv2-west);

\draw [connection]  (conv5_2_conv2-east) -- node {\midarrow} (conv5_2_conv3-west);

\pic[shift=(1,0,0)] at (conv5_2_conv3-east) {
    Box={
        name=conv5_3_conv1,
        caption=1x1,
        xlabel={ 512, },
        zlabel=512,
        fill=\ConvColor,
        height=16,
        width=1,
        depth=16
    }
};

\pic[shift=(1,0,0)] at (conv5_3_conv1-east) {
    Box={
        name=conv5_3_conv2,
        caption=3x3,
        xlabel={ 512, },
        zlabel=512,
        fill=\ConvColor,
        height=16,
        width=2,
        depth=16
    }
};

\pic[shift=(1,0,0)] at (conv5_3_conv2-east) {
    Box={
        name=conv5_3_conv3,
        caption=1x1,
        xlabel={ 2048, },
        zlabel=2048,
        fill=\ConvColor,
        height=16,
        width=1,
        depth=16
    }
};

\draw [connection]  (conv5_3_conv1-east) -- node {\midarrow} (conv5_3_conv2-west);

\draw [connection]  (conv5_3_conv2-east) -- node {\midarrow} (conv5_3_conv3-west);

\pic[shift=(1,0,0)] at (conv5_3_conv3-east) {
    Box={
        name=avgpool,
        caption=AvgPool,
        fill=\PoolColor,
        opacity=0.5,
        height=1,
        width=1,
        depth=1
    }
};

\pic[shift=(2,0,0)] at (avgpool-east) {
    Box={
        name=fc,
        caption=FC + Softmax,
        xlabel={" ","dummy"},
        zlabel=1000,
        fill=\SoftmaxColor,
        opacity=0.8,
        height=3,
        width=1.5,
        depth=25
    }
};

\end{tikzpicture}
\end{document}
